(this["webpackJsonpgsi-front"]=this["webpackJsonpgsi-front"]||[]).push([[0],{120:function(e,t,a){},172:function(e,t,a){},267:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(26),c=a.n(s),o=(a(172),a(120),a(40)),i=a(157),l=a(81),u=a(24),d=a(25),j=a(165),b="ACTION_SET_USER",p="ACTION_SET_LOGGED_IN",g=function(e){return{payload:e,type:b}},h=function(e){return{payload:e,type:p}};function O(e,t){switch(t.type){case b:return console.log("USER",t.payload),Object(d.a)(Object(d.a)({},e),{},{user:t.payload});case p:return Object(d.a)(Object(d.a)({},e),{},{loggedIn:t.payload});default:return e}}var m=a(6),x={loggedIn:!1,loggedInUser:null},f=n.a.createContext(x);function y(e){var t=e.children,a=n.a.useReducer(O,x),r=Object(o.a)(a,2),s=r[0],c=r[1];return Object(m.jsx)(f.Provider,{value:{globalState:s,globalDispatch:c},children:t})}var v=function(){return Object(r.useContext)(f)};function w(e){var t=e.component,a=Object(j.a)(e,["component"]),r=v().globalState;return Object(m.jsx)(u.b,Object(d.a)(Object(d.a)({},a),{},{render:function(e){return console.log("auth hreer",a),r&&"object"===typeof r.loggedInUser&&!1!==r.loggedIn?Object(m.jsx)(t,Object(d.a)({},e)):Object(m.jsx)(u.a,{to:{pathname:"/login",state:{from:e.location}}})}}))}var S=a(28),T=a.n(S),k=a(44),C=a(166),I=a(167),E=a(274),P=a(280),_=a(270),R=a(271),U=a(77),A=a(273),D=a(277),F=a(150),L=a(116),B=a.n(L),H="number"===typeof Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).TIMEOUT?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).TIMEOUT:1e3,N="/api/";function q(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=window._token||"",s={Authorization:"Bearer "+n},c=N;return t="POST"===a?B.a.post(e,r,{baseURL:c,headers:s}):"PUT"===a?B.a.put(e,r,{baseURL:c,headers:s,timeout:H}):B.a.get(e,{baseURL:c,params:r,headers:s,timeout:H}),new Promise((function(a,r){t.then((function(t){var r=t.data,n={error:!0,message:"Could not complete request",data:null};n=r?{error:!r.success,message:r.message,data:r.data}:{error:!0,message:"Could not complete request"},console.log("resultData "+e,n),a(n)})).catch((function(e){console.log("ERRROROOROR",e);var t={error:!0,message:"",data:"Api error"};e.response?t.data=e.response.data.message:t.data=e.message,a(t)}))}))}var G=function(e){var t=Object(r.useState)(),a=Object(o.a)(t,2),n=a[0],s=a[1],c=Object(r.useState)(!1),l=Object(o.a)(c,2),u=l[0],d=l[1],j=v().globalState,b=Object(r.useState)(!1),p=Object(o.a)(b,2),g=p[0],h=p[1];Object(r.useEffect)((function(){O()}),[]),Object(r.useEffect)((function(){if(n&&!n.status&&!g){h(!0);var e=n.playerHealth>0?"success":"error";C.a[e]({message:"success"===e?"You won!":"Dragon won"})}}),[n]);var O=function(){var t=Object(k.a)(T.a.mark((function t(){var a,r;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.match.params.gameId,t.next=3,q("game/"+a);case 3:(r=t.sent).error?s(null):s(r.data);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),x=function(){var t=Object(k.a)(T.a.mark((function t(){var a,r,n,c=arguments;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>0&&void 0!==c[0]&&c[0],r=e.match.params.gameId,d(!0),t.prev=3,t.next=6,q("game/user-attack/"+r,"POST",{powerAttack:a});case 6:n=t.sent,d(!1),n.error?I.b.error("Could not attack"):s(n.data),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),d(!1);case 14:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(){return t.apply(this,arguments)}}(),f=function(){var t=Object(k.a)(T.a.mark((function t(){var a,r;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.match.params.gameId,n&&n.status){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,q("game/dragon-attack/"+a,"POST",{});case 6:(r=t.sent).error?I.b.error("Could not attack"):s(r.data),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),d(!1);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(){return t.apply(this,arguments)}}();Object(F.a)(f,2e3);var y=function(){var t=Object(k.a)(T.a.mark((function t(){var a,r;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.match.params.gameId,!(n&&n.playerHealth<=0)){t.next=3;break}return t.abrupt("return");case 3:return d(!0),t.prev=4,t.next=7,q("game/giveup/"+a,"POST",{});case 7:r=t.sent,d(!1),r.error?I.b.error("Could not attack"):s(r.data),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),d(!1);case 15:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(){return t.apply(this,arguments)}}();return Object(m.jsx)(r.Fragment,{children:n?Object(m.jsx)(E.a,{title:"",className:"site-page-header",subTitle:"This is a subtitle",tags:n.status?Object(m.jsx)(P.a,{color:"blue",children:"Running"}):"Player"===n.wonBy?Object(m.jsx)(P.a,{color:"green",children:"Player won"}):Object(m.jsx)(P.a,{color:"red",children:"Dragon won"}),extra:[],children:Object(m.jsxs)(_.a,{children:[Object(m.jsxs)(R.a,{span:14,style:{paddingLeft:25,paddingRight:25},children:[Object(m.jsxs)(_.a,{children:[Object(m.jsxs)(R.a,{span:12,style:{textAlign:"center",paddingLeft:25,paddingRight:25},children:[Object(m.jsx)("h3",{children:j.user.name}),Object(m.jsx)(U.a,{type:"primary",size:"large",block:!0,style:{background:"green"},children:n.playerHealth})]}),Object(m.jsxs)(R.a,{span:12,style:{textAlign:"center",paddingLeft:5,paddingRight:5},children:[Object(m.jsx)("h3",{children:"Dragon"}),Object(m.jsx)(U.a,{type:"primary",size:"large",block:!0,danger:!0,children:n.dragonHealth})]})]}),n.status&&Object(m.jsxs)("div",{style:{textAlign:"center",marginTop:30},children:[Object(m.jsx)("h3",{children:"Action Buttons"}),Object(m.jsx)(U.a,{size:"large",disabled:u,onClick:function(){return x()},style:{marginRight:10},type:"primary",children:"ATTACK"}),Object(m.jsx)(U.a,{size:"large",disabled:u,onClick:function(){return x(!0)},style:{marginRight:10},type:"primary",children:"BLAST"}),Object(m.jsx)(U.a,{size:"large",disabled:u,onClick:y,style:{marginRight:10},type:"primary",children:"GIVE UP"})]})]}),Object(m.jsx)(R.a,{span:8,children:Object(m.jsx)(A.b,{style:{height:400,overflow:"auto",width:"100%"},header:Object(m.jsx)("div",{children:"Commentry Box"}),bordered:!0,dataSource:n.logs,renderItem:function(e){return Object(m.jsx)(A.b.Item,{children:e.log})}})})]})}):null===n?Object(m.jsx)(D.a,{title:"Error",status:"error",subTitle:"Could not find game",extra:Object(m.jsx)(U.a,{onClick:function(){return e.history.goBack()},type:"primary",children:"Go Back"},"console")}):Object(m.jsx)(i.a,{size:"large"})})},K=a(281);var z=function(e){var t=v().globalState,a=function(){var t=Object(k.a)(T.a.mark((function t(){var a;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,q("/game","POST",{});case 3:(a=t.sent).error?I.b.error("Could not create game!"):e.history.push("/game/"+a.data._id),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),I.b.error("Could not create game!");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return Object(m.jsx)(D.a,{title:"Hello ".concat(t.user.name),icon:Object(m.jsx)(K.a,{}),subTitle:"Email - ".concat(t.user.email),extra:Object(m.jsx)(U.a,{onClick:a,type:"primary",children:"Start New Game"},"console")})},V=a(272),W=a(275),M=a(279),J=a(276),Y="GSI_TOKEN";function Q(e){return localStorage.setItem(Y,e)}V.a.Content;var X={labelCol:{span:8},wrapperCol:{span:12}},Z={wrapperCol:{offset:8,span:16}},$=function(e){var t=n.a.useState(),a=Object(o.a)(t,2),r=a[0],s=a[1],c=v(),i=(c.globalState,c.globalDispatch),u=function(){var t=Object(k.a)(T.a.mark((function t(a){var r,n;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s(""),t.next=3,q("login","POST",a);case 3:if(r=t.sent,console.log({response:r}),!r.error){t.next=8;break}return s("string"===typeof r.data?r.data:r.message||"Something went wrong"),t.abrupt("return");case 8:return i(h(!!r.data)),window._token=r.data._token,Q(r.data._token),t.next=13,q("currentUser");case 13:(n=t.sent).error||i(g(n.data)),e.history.push("/");case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(m.jsx)(V.a,{style:{height:"100vh"},children:Object(m.jsx)(_.a,{gutter:16,justify:"center",align:"middle",children:Object(m.jsxs)(R.a,{span:12,style:{padding:20},children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"Login"}),Object(m.jsxs)(W.a,Object(d.a)(Object(d.a)({},X),{},{name:"basic",initialValues:{remember:!0},onFinish:u,onFinishFailed:function(e){console.log("Failed:",e)},children:[r&&Object(m.jsx)(M.a,{message:r,type:"error"}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)(W.a.Item,{label:"Email",name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your username!"}],children:Object(m.jsx)(J.a,{})}),Object(m.jsx)(W.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(m.jsx)(J.a.Password,{})}),Object(m.jsxs)(W.a.Item,Object(d.a)(Object(d.a)({},Z),{},{children:[Object(m.jsx)(U.a,{type:"primary",htmlType:"submit",children:"Submit"}),"\xa0\xa0\xa0",Object(m.jsx)(l.b,{to:"/register",children:"Register"})]}))]}))]})})})},ee=a(278),te=(V.a.Content,{labelCol:{span:8},wrapperCol:{span:16}}),ae={wrapperCol:{offset:8,span:16}},re=function(e){var t=n.a.useState(),a=Object(o.a)(t,2),r=a[0],s=a[1],c=v(),i=(c.globalState,c.globalDispatch),l=function(){var t=Object(k.a)(T.a.mark((function t(a){var r,n;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s(""),t.next=3,q("register","POST",a);case 3:if(r=t.sent,console.log({response:r}),!r.error){t.next=8;break}return s("string"===typeof r.data?r.data:r.message||"Something went wrong"),t.abrupt("return");case 8:return i(h(!!r.data)),window._token=r.data._token,Q(r.data._token),t.next=13,q("currentUser");case 13:(n=t.sent).error||i(g(n.data)),e.history.push("/");case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(m.jsx)(V.a,{style:{height:"100vh"},children:Object(m.jsx)(_.a,{gutter:16,justify:"center",align:"middle",children:Object(m.jsxs)(R.a,{span:18,style:{padding:20},children:[Object(m.jsx)("h1",{style:{textAlign:"center"},children:"Register"}),Object(m.jsxs)(W.a,Object(d.a)(Object(d.a)({},te),{},{name:"basic",initialValues:{remember:!0},onFinish:l,onFinishFailed:function(e){console.log("Failed:",e)},children:[r&&Object(m.jsx)(M.a,{message:r,type:"error"}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)(W.a.Item,{label:"name",name:"name",rules:[{required:!0,message:"Please input your name!"}],children:Object(m.jsx)(J.a,{})}),Object(m.jsx)(W.a.Item,{label:"Email",name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your username!"}],children:Object(m.jsx)(J.a,{})}),Object(m.jsx)(W.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(m.jsx)(J.a.Password,{})}),Object(m.jsx)(W.a.Item,{label:"Confirm Password",name:"cpassword",rules:[{required:!0,message:"Please input your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("password")!==a?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}}],children:Object(m.jsx)(J.a.Password,{})}),Object(m.jsx)(W.a.Item,Object(d.a)(Object(d.a)({},ae),{},{name:"remember",valuePropName:"checked",children:Object(m.jsx)(ee.a,{children:"Remember me"})})),Object(m.jsx)(W.a.Item,Object(d.a)(Object(d.a)({},ae),{},{children:Object(m.jsx)(U.a,{type:"primary",htmlType:"submit",children:"Submit"})}))]}))]})})})};function ne(e){e.component;var t=v(),a=t.globalState,n=t.globalDispatch,s=Object(r.useState)(!1),c=Object(o.a)(s,2),d=c[0],j=c[1];return Object(r.useEffect)((function(){try{var e=localStorage.getItem(Y);console.log({token:e}),e&&(j(!0),window._token=e,q("/currentUser").then((function(e){j(!1),e.error?console.log("Invalid User"+e.message):(n(g(e.data)),n(h(!!e.data)))})))}catch(t){j(!1)}}),[]),d?Object(m.jsx)(i.a,{}):Object(m.jsx)(l.a,{children:Object(m.jsxs)(u.d,{children:[Object(m.jsx)(w,{auth:{user:a.loggedInUser},exact:!0,path:"/",component:z}),Object(m.jsx)(w,{exact:!0,path:"/game/:gameId",component:G}),Object(m.jsx)(u.b,{exact:!0,path:"/login",component:$}),Object(m.jsx)(u.b,{exact:!0,path:"/register",component:re})]})})}var se=function(){return Object(r.useEffect)((function(){var e=localStorage.getItem("GSI_token");e&&(window._token=e)}),[]),Object(m.jsx)(y,{children:Object(m.jsx)(ne,{})})},ce=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,282)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),r(e),n(e),s(e),c(e)}))};c.a.render(Object(m.jsx)(n.a.StrictMode,{children:Object(m.jsx)(se,{})}),document.getElementById("root")),ce()}},[[267,1,2]]]);
//# sourceMappingURL=main.15727d1b.chunk.js.map